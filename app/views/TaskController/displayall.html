#{extends 'main.html'/}

#{list items:listTasks, as:'task'}
<table id="list_task">
    <tr>
        <th>Status de tâches</th>
    </tr>

      #{if task.urgent ==0}
      <tr id="urgent">
          <div id="Task"+${task_id}>${task.name}:<br />

              #{if task.creation}
                  Date de création: ${task.creation.format("dd/MM/yyyy")}
              #{/if}
          *{@{if (task.urgent == 1) }*

              <form action="@{TaskController.changeUserTask}" method="post">
                  Nom de la tache: ${task.name} ${task.urgent ? "" : "(Urgent)"} <br />
                  Description: ${task.content} <br />
                  <a> Utilisateur associé:<SELECT name="userId" >
                      #{list items:listUsers, as:'user'}
                          <OPTION value="${user.id}" ${(task.user && (user.id == task.user.id)) ? "selected" : ""}>${user.name}</OPTION>
                      #{/list}
                  </SELECT>
                  </a>
                      <input type="hidden" name="taskId" value="${task.id}" />
                      <input type="submit" value="Changer utilisateur" /><br>
              </form>
          </div>

    </tr>
      #{/if}
      #{else}
    <tr id="non_urgent">

        <div id="Task"+${task_id}>${task.name}:<br />

        #{if task.creation}
            Date de création: ${task.creation.format("dd/MM/yyyy")}
        #{/if}
        *{@{if (task.urgent == 1) }*

            <form action="@{TaskController.changeUserTask}" method="post">
                Nom de la tache: ${task.name} ${task.urgent ? "" : "(Urgent)"} <br />
                Description: ${task.content} <br />
                <a> Utilisateur associé:<SELECT name="userId" >
                #{list items:listUsers, as:'user'}
                    <OPTION value="${user.id}" ${(task.user && (user.id == task.user.id)) ? "selected" : ""}>${user.name}</OPTION>
                #{/list}
                </SELECT>
                </a>
                <input type="hidden" name="taskId" value="${task.id}" />
                <input type="submit" value="Changer utilisateur" /><br>
            </form>
        </div>
    #{/else}

    </tr>


#{/list}
</table>



<a href="@{Application.index}">Retour vers l'accueil</a>